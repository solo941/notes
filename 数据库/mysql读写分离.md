## 什么是mysql读写分离

主服务器处理写操作和实时性高的读操作，从服务器处理读操作。

主服务器将数据更新写入Binary log中，由从服务器的I/O进程读取，并写入从服务器的Relay log中，最后由从服务器SQL进程读取Relay log,解析主服务器的数据更改从服务器中Replay。

读写分离的优点：

- 缓解锁的争用
- 从服务器使用MyISAM，提升查询性能和开销；
- 增加冗余，提高可用性

## mysql主从复制引起的数据不同步问题

问题分析：主服务器写入后，如果立即在从服务器中读取并更新，因为主从同步延时问题，在高峰期时更新失败。这是因为从库同步主库数据过程是串行化的，而主库是并行写入，因此会出现主从同步延时。

解决方法：

Mysql有两种机制解决同步时延问题：并行复制和半同步复制：

并行复制：从库开启多线程，并行读取并执行relay log里的日志，这是库级别的并行；

半同步复制：主库写入binlog日志之后，强制立即将数据同步到从库，从库将日志写入本地relay log后，返回一个ack，主库接收到至少一个从库ack后会确认写操作完成。

操作：

首先使用

```
show status查看Seconds+Behind_Master，确定主从复制的数据延迟
```

采取措施：

- 分库：降低每个主库的写并发
- 从库开启并行复制，但如果某个库写并发特别高，并行复制是没有意义的。

