# HTTP

## 1.请求报文和响应报文

### 请求报文

![pic](https://github.com/solo941/notes/blob/master/计算机网络/pics/httprequest.png)

### 响应报文

![pic](https://github.com/solo941/notes/blob/master/计算机网络/pics/httpResponse.png)

### 请求方法

客户端发送的请求报文第一行为请求行，包含了方法字段。

#### GET

当前网络请求中，绝大部分使用的是 GET 方法。

#### HEAD

和 GET 方法类似，但是不返回报文实体主体部分。主要用于确认 URL 的有效性以及资源更新的日期时间等。

#### POST

POST 主要用来传输数据,下发报文使能接口，注册用户这些功能都是使用POST。

其它几种请求方法平时不太常用：**PUT**：上传文件，存在安全性问题，一般不使用该方法；**PATCH**：与PUT不同，可以部分修改原始资源；**DELETE**：与PUT相反，上传文件；**OPTIONS**：查询支持的方法；**CONNECT**：

在与代理服务器通信时建立隧道；**TRACE**：服务器会将通信路径返回给客户端，存在安全问题，一般不使用。

## 2.状态码

常见状态码：

100：表明到目前为止都很正常，客户端可以继续发送请求或者忽略这个响应。

200：OK；204：请求已经成功处理，但是返回的响应报文不包含实体的主体部分。

301：永久性重定向；302：临时性重定向；303：和 302 有着相同的功能，但是 303 明确要求客户端应该采用 GET 方法获取资源。

大多数浏览器都会在 301、302 和 303 状态下的重定向把 POST 方法改成 GET 方法。

304 ：如果请求报文首部包含一些条件，如果不满足条件，则服务器会返回 304 状态码。

400 ：请求报文中存在语法错误；401 :发送的请求需要有认证信息（BASIC 认证、DIGEST 认证）。如果之前已进行过一次请求，则表示用户认证失败;403：请求被拒绝；404 ：Not Found

500 :服务器正在执行请求时发生错误；503:服务器暂时处于超负载或正在进行停机维护，现在无法处理请求。

## 3.缓存

### 定义

Http中具有缓存功能的是浏览器缓存和代理服务器缓存。当web请求到达缓存时，如果本地有已缓存的副本，可以从本地存储中提取内容。缓存具有缓解服务器压力，降低资源获取延迟的优势。

浏览器加载页面流程：

- 浏览器根据http头信息，确定是否命中强缓存，命中直接加载，否则请求发送到服务器。
- 服务器判断浏览器缓存是否失效，如果可以使用，服务器不返回资源，资源从浏览器加载。
- 否则，浏览器加载服务器资源，并更新缓存。

### Cache-Control

Http通过Cache-Control首部字段控制缓存

#### no-store

no-store 指令规定不能对请求或响应的任何一部分进行缓存。

#### no-cache

no-cache 指令规定缓存服务器需要先向源服务器验证缓存资源的有效性，只有当缓存资源有效时才能使用该缓存对客户端的请求进行响应。

#### private

private 指令规定了将资源作为私有缓存，只能被单独用户使用，一般存储在用户浏览器中。

#### public

public 指令规定了将资源作为公共缓存，可以被多个用户使用，一般存储在代理服务器中。

#### max-age

max-age 指令出现在请求报文，并且缓存资源的缓存时间小于该指令指定的时间，那么就能接受该缓存。max-age 指令出现在响应报文，表示缓存资源在缓存服务器中保存的时间。

### 其它首部字段

#### ETag 

资源的唯一标识。URL 不能唯一表示资源，例如 `http://www.google.com/` 有中文和英文两个资源，只有 ETag 才能对这两个资源进行唯一标识。

#### Last-Modified

用于缓存验证，它包含在源服务器发送的响应报文中，指示源服务器对资源的最后修改时间。

#### Expires

用于告知缓存服务器该资源什么时候会过期。